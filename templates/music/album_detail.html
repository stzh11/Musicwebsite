

{% block title %}{{ album.title }}{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto px-4 py-8">

  {# ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî –•—ç–¥–µ—Ä –∞–ª—å–±–æ–º–∞ ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî #}
  <div class="flex flex-col md:flex-row items-start md:items-center mb-8">
    {% if album.cover.url %}
      <img src="{{ album.cover.url }}"
           alt="{{ album.title }}"
           class="w-full md:w-48 h-48 object-cover rounded-lg shadow mr-6 mb-4 md:mb-0">
    {% else %}
      <div class="w-full md:w-48 h-48 bg-gray-100 flex items-center justify-center rounded-lg shadow mr-6 mb-4 md:mb-0">
        <span class="text-gray-400">–ù–µ—Ç –æ–±–ª–æ–∂–∫–∏</span>
      </div>
    {% endif %}
    <div>
      <h1 class="text-4xl font-bold mb-2">{{ album.title }}</h1>
      {% if album.released_date %}
        <p class="text-sm text-gray-500 mb-1">–î–∞—Ç–∞ –≤—ã—Ö–æ–¥–∞: {{ album.released_date|date:"d.m.Y" }}</p>
      {% endif %}
      {% if album.description %}
        <p class="text-gray-700">{{ album.description }}</p>
      {% endif %}
    </div>
    <form action="{% url 'album-like-toggle' album.slug %}"
        method="post" style="display:inline">
          {% csrf_token %}
          {% if user.is_authenticated %}
            {% if user.id in likes.users %}
              <button type="submit" class="text-red-500 hover:text-red-700">
                ‚ù§Ô∏è –û—Ç–º–µ–Ω–∏—Ç—å –ª–∞–π–∫
              </button>
            {% else %}
              <button type="submit" class="text-gray-500 hover:text-gray-700">
                ü§ç –ü–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫
              </button>
            {% endif %}
          {% else %}
            <a href="{% url 'login' %}">–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –ª–∞–π–∫–∞—Ç—å</a>
          {% endif %}
      </form>
      <p>–õ–∞–π–∫–æ–≤: {{ likes.count }}</p>
  </div>

  <section class="mt-8">
  <h2 class="text-xl font-semibold mb-4">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h2>

  {% if album.comments.all %}
    <ul class="space-y-4">
      {% for c in album.comments.all %}
        <li class="border-b pb-2">
          <p class="text-sm text-gray-600">
            {{ c.author.username }} ¬∑ {{ c.created_at|date:"d.m.Y H:i" }}
          </p>
          <p>{{ c.text }}</p>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p class="text-gray-500">–ü–æ–∫–∞ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è.</p>
  {% endif %}
</section>

{# —Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è #}
<section class="mt-6">
  {% if user.is_authenticated %}
    <form action="{% url 'comments:album-add-comment' album.slug %}"
          method="post" class="space-y-2">
      {% csrf_token %}
      {{ form.text }}
      <button type="submit"
              class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded">
        –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
      </button>
    </form>
  {% else %}
    <p>
      <a href="{% url 'login' %}" class="text-blue-600 hover:underline">
        –í–æ–π–¥–∏—Ç–µ
      </a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.
    </p>
  {% endif %}
</section>

  {# ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∞–ª—å–±–æ–º–∞ ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî #}
  <section class="mb-12">
  <h2 class="text-2xl font-semibold mb-4">–£—á–∞—Å—Ç–Ω–∏–∫–∏</h2>
  <ul class="grid gap-4 sm:grid-cols-2 md:grid-cols-3">
    {% for artist, roles in artist_roles.items %}
      <li class="flex items-center space-x-3">
        <div>
          <a href="{{ artist.get_absolute_url }}"
             class="font-medium text-blue-500 hover:underline">
            {{ artist.name }}
          </a>
          <div class="text-sm text-gray-600">
            {{ roles|join:", " }}
          </div>
        </div>
      </li>
    {% empty %}
      <li class="text-gray-500">–ù–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.</li>
    {% endfor %}
    </ul>
    </section>

  {# ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî –°–ø–∏—Å–æ–∫ —Ç—Ä–µ–∫–æ–≤ –∞–ª—å–±–æ–º–∞ ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî #}
  <section>
    <h2 class="text-2xl font-semibold mb-4">–¢—Ä–µ–∫–∏</h2>
    <div class="space-y-6">
      {% for song in songs %}
        <div class="flex items-center space-x-4">
          {% if song.cover.url %}
            <img src="{{ song.cover.url }}"
                 alt="{{ song.title }}"
                 class="w-16 h-16 object-cover rounded">
          {% else %}
            <div class="w-16 h-16 bg-gray-100 rounded flex items-center justify-center">
              <span class="text-gray-400 text-xs">–û–±–ª–æ–∂–∫–∞</span>
            </div>
          {% endif %}
          <div>
            <a href="{{ song.get_absolute_url }}"
               class="text-lg font-medium hover:underline">
              {{ song.title }}
            </a>
            {% if song.released_date %}
              <div class="text-sm text-gray-500">–î–∞—Ç–∞ –≤—ã—Ö–æ–¥–∞: {{ song.released_date|date:"d.m.Y" }}</div>
            {% endif %}
          </div>
        </div>
      {% empty %}
        <p class="text-gray-500">–í —ç—Ç–æ–º –∞–ª—å–±–æ–º–µ –ø–æ–∫–∞ –Ω–µ—Ç —Ç—Ä–µ–∫–æ–≤.</p>
      {% endfor %}
    </div>
  </section>

</div>
{% endblock %}
